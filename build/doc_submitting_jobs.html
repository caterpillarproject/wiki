<!DOCTYPE html>
<html>
  <head>

 <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="An introduction to SLURM scripts as well as a few examples for submitting jobs to the cluster.">
<meta name="keywords" content="slurmpbssubmitjobsqueueclustermitbigbangstampede,  ">
<title>Submitting Jobs  | Caterpillar Wiki</title>
<link rel="stylesheet" type="text/css" href="css/syntax.css">
<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="css/modern-business.css">
<link rel="stylesheet" type="text/css" href="css/lavish-bootstrap.css">
<link rel="stylesheet" type="text/css" href="css/customstyles.css">
<link rel="stylesheet" type="text/css" href="css/theme-blue.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->







 

<script>
  $(function () {
      $('[data-toggle="tooltip"]').tooltip()
  })
</script>








  </head>

<body>

   <!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
           
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> The Caterpillar Project Wiki</span></a>
            
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                












                
                
                
                
                <li><a href="https://github.com/caterpillarproject/wiki" target="_blank">Github</a></li>
                
                
                
                


                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->

                <li class="dropdown">
                    


                <!-- special insertion -->

               
                <!-- Send feedback function -->
<script>
function SendLinkByMail(href) {
var subject= "Caterpillar Wiki feedback";
var body = "I have some feedback about the Submitting Jobs page: ";
body += window.location.href;
body += "";
var uri = "mailto:brendan.f.griffen@gmail.com?subject=";
uri += encodeURIComponent(subject);
uri += "&body=";
uri += encodeURIComponent(body);
window.location.href = uri;
}
</script>

<li><a href="javascript:(function()%7BSendLinkByMail()%3B%7D)()%3B" target="_blank"><i class="fa fa-envelope-o"></i> Feedback</a></li>


                <li>
                <!-- start search -->
                <div id="search-demo-container">
                <input type="text" id="search-input" placeholder="search...">
                <ul id="results-container"></ul>
                </div>
                <script src="js/jekyll-search.js" type="text/javascript"></script>
                <script type="text/javascript">
                SimpleJekyllSearch.init({
                searchInput: document.getElementById('search-input'),
                resultsContainer: document.getElementById('results-container'),
                dataSource: 'search.json',
                searchResultTemplate: '<li><a href="{url}" title="Submitting Jobs">{title}</a></li>',
                noResultsText: 'No results found.',
                limit: 10,
                fuzzy: true,
                })
                </script>
                <!-- end search -->
                </li>

                
<script type="text/javascript">

    $( document ).ready(function() {
        if (top.location == location)  {
            $(".escapeMe").remove();
        }

    });

            function breakout_of_frame() {
                if (top.location != location) {
                    window.open(window.location.href, '_blank');

                }

            }
</script>

<li class="escapeMe">
    <a href="#" onclick="breakout_of_frame()" ><i class="fa fa-sign-out"></i> Pop-out</a>
</li>



        <!-- /.container -->
                </ul>


</div></nav>


    <!-- Page Content -->
    <div class="container">
        <div class="col-lg-12">&nbsp;</div>


<!-- Content Row -->
<div class="row">
    <!-- Sidebar Column -->
    <div class="col-md-3">

        <script>

            $(document).ready(function() {
                        // Initialize navgoco with default options
                        $("#mysidebar").navgoco({
                            caretHtml: '',
                            accordion: true,
                            openClass: 'active', // open
                            save: false, // leave false or nav highlighting doesn't work right
                            cookie: {
                                name: 'navgoco',
                                expires: false,
                                path: '/'
                        },
                        slide: {
                            duration: 400,
                            easing: 'swing'
                                }
                                });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

            });

        </script>


        











        
        <ul id="mysidebar" class="nav">
            <center>
        <img title="logo" src="images/company_logo_big.png" style="max-width: 200px;" align="center">
        
            <span class="versionTagline">version 0.1</span>
            </center>

            
            
            
        
            
            <li><a href="#">Caterpillar</a>
                <ul>
                    
                    
                    
                    <li><a href="index.html">Welcome</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_history_motivation.html">History and Motiviation</a></li>
                    

                    

            
            
</ul>
        
        
            
            <li><a href="#">Simulation Overview</a>
                <ul>
                    
                    
                    
                    <li><a href="doc_initial_conditions.html">Initial Conditions</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_parent_simulation.html">Parent Simulation</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_zoomin_simulations.html">Zoom-in Simulations</a></li>
                    

                    

            
            
</ul>
        
        
            
            <li><a href="#">Data Access</a>
                <ul>
                    
                    
                    
                    <li><a href="doc_understanding_the_data.html">Understanding The Data</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_modules_and_analysis.html">Your Analysis Modules</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_data_access_examples.html">Access Examples</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_sams.html">Semi-analytic Models</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_datasets.html">Other Useful Postprocessed Datasets</a></li>
                    

                    

            
            
</ul>
        
        
            
            <li><a href="#">Codes & Halo Catalogues</a>
                <ul>
                    
                    
                    
                    <li><a href="doc_gadget.html">Gadget</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_rockstar.html">Rockstar</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_consistenttrees.html">Consistent-Trees</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_subfind.html">SUBFIND</a></li>
                    

                    

            
            
</ul>
        
        
            
            <li><a href="#">Compute Cluster Information</a>
                <ul>
                    
                    
                    
                    <li><a href="doc_mit_cluster.html">MIT - Antares & Bigbang</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_xsede.html">XSEDE - Stampede, Comet & Ranch</a></li>
                    

                    

            
            
                    
                    
                    <li class="active"><a href="doc_submitting_jobs.html">Submitting Jobs With SLURM</a></li>
                    

                    

            
            
</ul>
        
        
            
            <li><a href="#">Project Status</a>
                <ul>
                    
                    
                    
                    <li><a href="doc_project_status.html">Halo Progress</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_sam_progress.html">Semi-analytic Models</a></li>
                    

                    

            
            
                    
                    
                    <li><a href="doc_caterpillar_hydro.html">Caterpillar+Hydro</a></li>
                    

                    

            
            
</ul>
        
        
            
            <li><a href="#">Special Queries</a>
                <ul>
                    
                    
                    
                    <li><a href="doc_faq.html">FAQ</a></li>
                    

                    

            
            
</ul>
        
        
        




   <!-- if you aren't using the accordion, uncomment this block:

        <p class="external">
            <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
        </p>
    -->

    </div>
       <!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above.-->
    <script>$("li.active").parents('li').toggleClass("active");</script>


            <!-- Content Column -->
            <div class="col-md-9">

                <div class="post-header">
   <h1 class="post-title-main">Submitting Jobs</h1>
</div>

<div class="post-content">

   
    <div class="summary">An introduction to SLURM scripts as well as a few examples for submitting jobs to the cluster.</div>
   

    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    
    <a href="https://github.com/tomjohnson1492/documentation-theme-jekyll/blob/gh-pages/doc_submitting_jobs.md" class="btn btn-default " role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    

       <h2 id="example-slurm-submission-scripts">Example SLURM Submission Scripts</h2>

<p>Scripts can be submitted via using the command <code>sbatch sub.script</code>. There are a number of options you can specify but the key ones are listed here.</p>

<ul>
<li><p><code>#SBATCH -n 1</code>
This line sets the number of cores that you&#39;re requesting. Make sure that your tool can use multiple cores before requesting more than one.</p></li>
<li><p><code>#SBATCH -t 5</code>
This line specifies the running time for the job in minutes. If your job runs longer than the value you specify here, it will be cancelled. There is currently no time limit to jobs so you can leave this out for now.</p></li>
<li><p><code>#SBATCH -p RegNodes</code>
This line specifies the SLURM partition (AKA queue) under which the script will be run. The RegNodes partition is good for routine jobs that can handle being occasionally stopped and restarted. PENDING times are typically short for this queue as it has the most number of cores.</p></li>
<li><p><code>#SBATCH -o hostname.out</code>
This line specifies the file to which standard out will be appended. If a relative file name is used, it will be relative to your current working directory.</p></li>
<li><p><code>#SBATCH -e hostname.err</code>
This line specifies the file to which standard error will be appended. SLURM submission and processing errors will also appear in the file.</p></li>
<li><p><code>#SBATCH --mail-user=ajk@123.com</code>
The email address to which the --mail-type messages will be sent.</p></li>
<li><p><code>#SBATCH --mail-type=END</code>
Because jobs are processed in the &quot;background&quot; and can take some time to run, it is useful send an email message when the job has finished (--mail-type=END). Email can also be sent for other processing stages (START, FAIL) or at all of the times (ALL)</p></li>
</ul>

<p>Here a few example scripts. Contact [mailto:brendan.f.griffen@gmail.com Brendan Griffen] if you would like help constructing something more specific. [https://rc.fas.harvard.edu/resources/running-jobs/ Harvard FAS] has a great number of examples and useful tips.</p>

<ul>
<li>I have a simple serial job which doesn&#39;t require much memory.</li>
</ul>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH -n 1</span>
<span class="c">#SBATCH -o jobname.o%j</span>
<span class="c">#SBATCH -e jobname.e%j</span>
<span class="c">#SBATCH -p RegNodes</span>
<span class="c">#SBATCH -J jobname</span>
<span class="c">#SBATCH --share</span>

./job.exe
</code></pre></div>
<ul>
<li>I have an openMP task which requires a large amount of memory (up to 256GB).</li>
</ul>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH -N 1 -n 64</span>
<span class="c">#SBATCH -o jobname.o%j</span>
<span class="c">#SBATCH -e jobname.e%j</span>
<span class="c">#SBATCH -p AMD64</span>
<span class="c">#SBATCH -J jobname</span>

<span class="nb">export </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span>64
./job.exe
</code></pre></div>
<ul>
<li>I have a MPI job which doesn&#39;t use much memory.</li>
</ul>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH -N 2 -n 16</span>
<span class="c">#SBATCH -o jobname.o%j</span>
<span class="c">#SBATCH -e jobname.e%j</span>
<span class="c">#SBATCH -p RegNodes</span>
<span class="c">#SBATCH -J jobname</span>

mpirun -np <span class="m">16</span> ./P-Gadget3 param.txt 1&gt;OUTPUT 2&gt;ERROR
</code></pre></div>
<ul>
<li>I have a job which is requires lots of IO between MPI tasks but doesn&#39;t consume much memory.</li>
</ul>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH -n 16</span>
<span class="c">#SBATCH -o jobname.o%j</span>
<span class="c">#SBATCH -e jobname.e%j</span>
<span class="c">#SBATCH -p HyperNodes</span>
<span class="c">#SBATCH -J jobname</span>

mpirun -np <span class="m">16</span> ./job.exe
</code></pre></div>
<ul>
<li>I have a MPI job which requires a very large amount of memory.</li>
</ul>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH -n 128</span>
<span class="c">#SBATCH -o jobname.o%j</span>
<span class="c">#SBATCH -e jobname.e%j</span>
<span class="c">#SBATCH -p RegNodes</span>
<span class="c">#SBATCH -J jobname</span>

mpirun -np <span class="m">128</span> ./job.exe
</code></pre></div>
<h2 id="visualizing-cluster-usage">Visualizing Cluster Usage</h2>

<p>The cluster now can be visualized interactively. Just type <code>&gt; sview</code> in the command prompt on antares.mit.edu and you&#39;ll see the an infographic.</p>

<p>Alternatively, you can use Ganglia which can be found here: http://antares.mit.edu/ganglia/</p>

<h2 id="slurm-status-&amp;-error-help">SLURM Status &amp; Error Help</h2>

<h3 id="status-messages">Status Messages</h3>

<p>When you type <code>squeue -u username</code> you should see a shortened version of one of the following (e.g. PD for PENDING). You can also see these in the <code>sview</code>.</p>

<ul>
<li><p><code>PENDING</code> 
Job is awaiting a slot suitable for the requested resources. Jobs with high resource demands may spend significant time PENDING.</p></li>
<li><p><code>RUNNING</code> 
Job is running.</p></li>
<li><p><code>COMPLETED</code><br>
Job has finished and the command(s) have returned successfully (i.e. exit code 0).</p></li>
<li><p><code>CANCELLED</code><br>
Job has been terminated by the user or administrator using scancel.</p></li>
<li><p><code>FAILED</code><br>
Job finished with an exit code other than 0.</p></li>
</ul>

<h3 id="error-messages">Error Messages</h3>

<ul>
<li><p><code>JOB &lt;jobid&gt; CANCELLED AT &lt;time&gt; DUE TO TIME LIMIT</code><br>
You did not specify enough time in your batch submission script. The -t option sets time in minutes, or can also take hours:minutes:seconds form (12:30:00 for 12.5 hours)</p></li>
<li><p><code>Job &lt;jobid&gt; exceeded &lt;mem&gt; memory limit, being killed</code><br>
Your job is attempting to use more memory than you&#39;ve requested for it. Either increase the amount of memory requested by <code>--mem</code> or <code>--mem-per-cpu</code> or, if possible, reduce the amount your application is trying to use. For example, many Java programs set heap space using the <code>-Xmx</code> JVM option. This could potentially be reduced.</p></li>
<li><p><code>slurm_receive_msg: Socket timed out on send/recv operation</code><br>
This message indicates a failure of the SLURM controller. Though there are many possible explanations, it is generally due to an overwhelming number of jobs being submitted, or, occasionally, finishing simultaneously. If you want to figure out if SLURM is working use the <code>sdiag</code> command. <code>sdiag</code> should respond quickly in these situations and give you an idea as to what the scheduler is up to.</p></li>
<li><p><code>JOB &lt;jobid&gt; CANCELLED AT &lt;time&gt; DUE TO NODE FAILURE</code>
This message may arise for a variety of reasons, but it indicates that the host on which your job was running can no longer be contacted by SLURM.</p></li>
</ul>

<p>Again, see the <a href="https://rc.fas.harvard.edu/resources/running-jobs/">Harvard FAS SLURM website</a> for extra information and help.</p>


<div class="tags">
    
    <b>Tags: </b>
    











    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
</div>



    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'idrbwjekyll'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>



<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2015 Caterpillar Project. All rights reserved.<br />
<p>Page last updated:</span> November 3, 2015<br/> Site last generated: Nov 3, 2015 <br />
<p><img src="images/company_logo.jpg"/></p>
                </div>
            </div>
        </footer>

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

            </div><!-- /.row -->

    </div>    <!-- /.container -->

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-61923556-1', 'auto');
    ga('send', 'pageview');
</script>



</html>

